<html><head><link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/polymerfire/polymerfire.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="meetup-title.html">
<link rel="import" href="meetup-event.html">
<link rel="import" href="meetup-new-event.html">
<link rel="import" href="meetup-event-editor.html">

</head><body><dom-module id="meetup-events">
	<template>

		<style is="custom-style">section{@apply (--layout);@apply (--layout-wrap);@apply (--layout-center-justified);background-color:var(--light-gray);}paper-fab{--paper-fab-background:var(--secondary-color);--paper-fab-keyboard-focus-background:#104d82;position:fixed;bottom:40px;right:40px;z-index:5;}</style>

		
		<firebase-document id="events" app-name="meetup" data="{{data}}">
		</firebase-document>

		
		<firebase-query id="eventsQuery" app-name="meetup" path="/events" data="{{queryData}}">
		</firebase-query>

		<meetup-title title="Events"></meetup-title>

		
		<paper-fab icon="add" label="New Event" on-tap="openNew"></paper-fab>

		
		<meetup-new-event id="newEvent" on-submit="submitInfo">
		</meetup-new-event>

		
		<meetup-event-editor id="editor" on-delete="delete" on-save="save"></meetup-event-editor>

		
		<section>
			<template id="event" is="dom-repeat" items="[[queryData]]" as="event" initial-count="1">
				<meetup-event event-title="[[event.title]]" event-type="[[event.type]]" event-host="[[event.host]]" event-image="[[event.image]]" event-start="[[event.start]]" event-end="[[event.end]]" event-guests="[[event.guests]]" event-location="[[event.location]]" event-info="[[event.info]]" event-id="[[event.$key]]" on-open="openEditor">
				</meetup-event>
			</template>
		</section>

	</template>
	<script>Polymer({is:"meetup-events",properties:{myName:{type:String,value:"Nick"},data:{type:Object}},submitInfo:function(t,e){var n=this,s=t.detail;n.data={title:s.title,image:s.image,type:s.type,host:s.host,start:moment(s.start).format("MMM Do, YYYY h:mma"),end:moment(s.end).format("MMM Do, YYYY h:mma"),guests:s.guests,location:s.location,info:s.info},n.$.events.save("/events"),n.$.events.path=null},openNew:function(){this.$.newEvent.open(),this.$.events.path=null},openEditor:function(t,e){this.$.events.path="/events/"+t.detail.eventId,this.$.editor.open(t.detail)},save:function(t,e){var n=this,s=t.detail;n.data={title:s.title,image:s.image||"",type:s.type,host:s.host,start:s.start,end:s.end,guests:s.guests,location:s.location,info:s.info||""},n.$.events.setStoredValue(n.$.events.path,n.data).then(function(){n.$.events.path=null})},"delete":function(t,e){this.$.events.destroy(),this.$.events.path=null}});</script>
</dom-module></body></html>